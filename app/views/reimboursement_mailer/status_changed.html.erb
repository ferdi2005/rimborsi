<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
      }
      .header {
        background-color: #28a745;
        color: white;
        padding: 20px;
        text-align: center;
        border-radius: 5px 5px 0 0;
      }
      .content {
        background-color: #f8f9fa;
        padding: 20px;
        border: 1px solid #dee2e6;
      }
      .status-badge {
        display: inline-block;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: bold;
        color: white;
        background-color: #007bff;
      }
      .note {
        background-color: white;
        padding: 15px;
        border-left: 4px solid #28a745;
        margin: 15px 0;
      }
      .footer {
        background-color: #6c757d;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 12px;
        border-radius: 0 0 5px 5px;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Stato Rimborso Aggiornato</h1>
    </div>
    
    <div class="content">
      <p>Ciao <strong><%= @user.name %></strong>,</p>
      
      <p>Lo stato del tuo rimborso #<%= @reimboursement.id %> Ã¨ stato aggiornato.</p>
      
      <p style="text-align: center;">
        <span class="status-badge">
          Nuovo stato: <%= @reimboursement.status_in_italian %>
        </span>
      </p>
      
      <% if @note&.text.present? %>
        <div class="note">
          <p><strong>Nota dell'amministratore:</strong></p>
          <p><strong>Autore:</strong> <%= @author.name %> <%= @author.surname %></p>
          <p><strong>Data:</strong> <%= @note.created_at.strftime("%d/%m/%Y alle %H:%M") %></p>
          <p><%= simple_format(@note.text) %></p>
        </div>
      <% end %>
      
      <p>
        <strong>Totale rimborso:</strong> 
        â‚¬ <%= number_with_precision(@reimboursement.total_amount, precision: 2) %>
      </p>
    </div>
    
    <div class="footer">
      <p><strong>Gestione Rimborsi</strong></p>
      <% admin_email = ENV['EMAIL_AMMINISTRAZIONE'] || 'admin@rimborsi.app' %>
      <p>
        Per chiarimenti contatta: <a href="mailto:<%= admin_email %>" style="color: white;"><%= admin_email %></a><br>
        Puoi anche rispondere con eventuali note direttamente sulla piattaforma.
      </p>
      <p style="margin-top: 15px;">
        <a href="<%= Rails.application.routes.url_helpers.reimboursement_url(@reimboursement, host: request.base_url rescue 'localhost:3000') %>" style="color: white; text-decoration: underline;">
          ðŸ”— Vai al Rimborso
        </a> | 
        <a href="<%= Rails.application.routes.url_helpers.reimboursements_url(host: request.base_url rescue 'localhost:3000') %>" style="color: white; text-decoration: underline;">
          ðŸ“‹ Tutti i Rimborsi
        </a>
      </p>
    </div>
  </body>
</html>eimboursement#status_changed</h1>

<p>
  <%= @greeting %>, find me in app/views/reimboursement_mailer/status_changed.html.erb
</p>
