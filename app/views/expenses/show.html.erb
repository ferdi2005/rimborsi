<div class="container-fluid">
  <p id="notice"><%= notice %></p>
            <div class="form-group mb-3">
        <p><strong>Reimboursment:</strong></p>
        <div>
          <%= @expense.reimboursement_id %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Purpose:</strong></p>
        <div>
          <%= @expense.purpose %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Date:</strong></p>
        <div>
          <%= @expense.date %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Amount:</strong></p>
        <div>
          <%= @expense.amount %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Car:</strong></p>
        <div>
          <%= @expense.car %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Calculation date:</strong></p>
        <div>
          <%= @expense.calculation_date %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Departure:</strong></p>
        <div>
          <%= @expense.departure %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Arrival:</strong></p>
        <div>
          <%= @expense.arrival %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Distance:</strong></p>
        <div>
          <%= @expense.distance %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Return trip:</strong></p>
        <div>
          <%= @expense.return_trip %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>vehicle_category:</strong></p>
        <div>
          <%= @expense.vehicle_category_id %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Brand:</strong></p>
        <div>
          <%= @expense.brand %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Model:</strong></p>
        <div>
          <%= @expense.model %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Fuel:</strong></p>
        <div>
          <%= @expense.fuel_id %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Quota capitale:</strong></p>
        <div>
          <%= @expense.quota_capitale %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Carburante:</strong></p>
        <div>
          <%= @expense.carburante %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Pneumatici:</strong></p>
        <div>
          <%= @expense.pneumatici %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Manutenzione:</strong></p>
        <div>
          <%= @expense.manutenzione %>
        </div>
      </div>
                <div class="form-group mb-3">
        <p><strong>Project:</strong></p>
        <div>
          <%= @expense.project_id %>
        </div>
      </div>

      <!-- Sezione Allegato -->
      <% unless @expense.car? %>
        <div class="form-group mb-3">
          <p><strong>Allegato:</strong></p>
          <div>
            <% if @expense.attachment.attached? %>
              <% if @expense.electronic_invoice? && @expense.has_invoice_pdf? %>
                <!-- Mostra PDF della fattura elettronica -->
                <div class="card">
                  <div class="card-header d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">
                      <i class="fas fa-file-invoice me-2"></i>Fattura Elettronica
                    </h6>
                    <div>
                      <%= link_to "Scarica PDF", download_invoice_pdf_expense_path(@expense), 
                                  class: "btn btn-sm btn-primary me-2" %>
                      <%= link_to "File Originale", @expense.attachment, 
                                  class: "btn btn-sm btn-outline-secondary" %>
                    </div>
                  </div>
                  <div class="card-body">
                    <iframe src="<%= url_for(@expense.pdf_attachment) %>" 
                            width="100%" 
                            height="600" 
                            style="border: none;" 
                            class="rounded">
                      Il tuo browser non supporta la visualizzazione di PDF.
                    </iframe>
                  </div>
                </div>
              <% elsif @expense.attachment.content_type.start_with?('image/') %>
                <!-- Mostra immagine -->
                <div class="text-center">
                  <%= image_tag @expense.attachment, class: "img-fluid rounded shadow", style: "max-height: 500px;" %>
                  <div class="mt-3">
                    <%= link_to "Visualizza a Schermo Intero", @expense.attachment, target: "_blank", 
                                class: "btn btn-outline-primary" %>
                  </div>
                </div>
              <% elsif @expense.attachment.content_type == 'application/pdf' %>
                <!-- Mostra PDF normale -->
                <div class="card">
                  <div class="card-header d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">
                      <i class="fas fa-file-pdf me-2"></i>Documento PDF
                    </h6>
                    <%= link_to "Scarica", @expense.attachment, download: true, 
                                class: "btn btn-sm btn-outline-primary" %>
                  </div>
                  <div class="card-body p-0">
                    <iframe src="<%= url_for(@expense.attachment) %>" 
                            width="100%" 
                            height="600" 
                            style="border: none;">
                      Il tuo browser non supporta la visualizzazione di PDF.
                    </iframe>
                  </div>
                </div>
              <% else %>
                <!-- Altro tipo di file -->
                <div class="card">
                  <div class="card-body text-center">
                    <i class="fas fa-file fa-5x text-secondary mb-3"></i>
                    <p><strong>File:</strong> <%= @expense.attachment.filename %></p>
                    <p><strong>Dimensione:</strong> <%= number_to_human_size(@expense.attachment.byte_size) %></p>
                    <%= link_to "Scarica File", @expense.attachment, target: "_blank", 
                                class: "btn btn-outline-primary" %>
                  </div>
                </div>
              <% end %>
            <% else %>
              <div class="alert alert-info">
                <i class="fas fa-info-circle"></i>
                Nessun allegato presente per questa spesa.
              </div>
            <% end %>
          </div>
        </div>
      <% end %>

        <%= link_to 'Edit', edit_expense_path(@expense), class: "btn btn-primary" %>
  <%= link_to 'Back', expenses_path, class: "btn btn-secondary" %>
</div>
